# Webserv Redirect Test Configuration
# ====================================
#
# This configuration file demonstrates HTTP redirections.
# Use with: ./webserv config/redirect_test.conf
#
# Test commands (once network is implemented):
#   curl -v http://localhost:8080/old-page
#   curl -v http://localhost:8080/temp-redirect
#   curl -v -L http://localhost:8080/old-page  # Follow redirects

server {
    listen 8080;
    server_name localhost;

    # Maximum request body size
    client_max_body_size 10M;

    # Custom error pages
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;

    # ================================================
    # Redirect Examples
    # ================================================

    # Example 1: Permanent redirect (301)
    # -----------------------------------
    # Use for URLs that have permanently moved.
    # Browsers cache 301 redirects.
    # Search engines update their index.
    location /old-page {
        return 301 /new-page;
    }

    # Example 2: Temporary redirect (302)
    # -----------------------------------
    # Use for temporary moves (maintenance, etc.)
    # Browsers don't cache 302 redirects.
    location /temp-redirect {
        return 302 /temporary-location;
    }

    # Example 3: Redirect to external URL
    # ------------------------------------
    # Redirect to a completely different domain.
    location /go-external {
        return 301 https://www.example.com;
    }

    # Example 4: Redirect old API endpoint
    # ------------------------------------
    # Common use case: API versioning
    location /api/v1 {
        return 301 /api/v2;
    }

    # Example 5: Force trailing slash
    # --------------------------------
    # Redirect /about to /about/ for consistency
    location /about {
        return 301 /about/;
    }

    # ================================================
    # Normal locations (no redirect)
    # ================================================

    # The new page that redirects point to
    location /new-page {
        root www;
        index index.html;
        allowed_methods GET;
    }

    # Temporary location
    location /temporary-location {
        root www;
        index maintenance.html;
        allowed_methods GET;
    }

    # About section with trailing slash
    location /about/ {
        root www;
        index about.html;
        allowed_methods GET;
    }

    # API v2 endpoint
    location /api/v2 {
        root www;
        index api.html;
        allowed_methods GET POST;
    }

    # Default location
    location / {
        root www;
        index index.html;
        allowed_methods GET;
        autoindex off;
    }
}
